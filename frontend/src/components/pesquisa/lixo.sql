       DIV_ZERO (SUM (NVLCUSTO), SUM (NQTUNID)) NPRUNIT,
       DIV_ZERO (SUM (NVLPROD), SUM (NQTPROD)) NPRPROD,
       SUM (NKGBRUTO) NKGBRUTO, SUM (NVLLUCROPREV) NVLLUCROPREV,
       SUM (NVLDO) NVLDO, SUM (NVLTOTAL) AS NVLTOTAL, SUM (NVLPROD) NVLPROD,
       SUM (NVLDESCON) NVLDESCON,sum(NVLOUTRAS)NVLOUTRAS, SUM (NVLCUSTO) NVLCUSTO,
       SUM (NVLCUSTOADD) NVLCUSTOADD, SUM (NVLFRETE) NVLFRETE,
       SUM (NVLFRETEINTERNO) NVLFRETEINTERNO, SUM (NVLCOMISSAO) NVLCOMISSAO,
       DIV_ZERO (SUM (NVLCOMISSAO), SUM (NVLPROD)) * 100 NTXCOMIS,
       SUM (NVLIMPOSTO) NVLIMPOSTO, SUM (NVLIMP_AGREGA) NVLIMP_AGREGA,
       AVG (NTXABAT) NTXABAT, SUM (NVLICMS) NVLICMS, SUM (NVLPIS) NVLPIS,
       SUM (NVLCOFINS) NVLCOFINS, SUM (NVLIPI) NVLIPI, SUM (NVLSBT) NVLSBT,
       SUM (NVLFECOP_ST) NVLFECOP_ST, SUM(NVLICMS_DIFAL)NVLICMS_DIFAL,
       SUM (NVLRECLIQ) NVLRECLIQ,
       SUM (NVLBONIFICA) NVLBONIFICA, SUM (NVLCUSTOBONIFICA) NVLCUSTOBONIFICA,
       SUM (NVLCM) NVLCM,
       DIV_ZERO (SUM (NVLCUSTO),SUM (NVLPROD)) * 100 PCUSTO,(1- (DIV_ZERO ((SUM (NVLCUSTO + NVLCOMISSAO + NVLICMS + NVLCOFINS+ NVLPIS)),
       SUM (NVLPROD))))* 100 NTXMC,
       DIV_ZERO (SUM (NVLPROD) + SUM (NVLIPI), SUM (NQTPROD)) NVLUNIT
  FROM WRPT_VENDAS_LUCRO Where 1=1 and WRPT_VENDAS_LUCRO.LVENDAVEL between 1 and 1 and DDTFATURAM between TO_DATE('01/01/2020 00:00:00','DD/MM/YYYY HH24:MI:SS') and TO_DATE('15/05/2020 23:59:59','DD/MM/YYYY HH24:MI:SS' )  and WRPT_VENDAS_LUCRO.CCDTYOPER between 1400 and 1400 and WRPT_VENDAS_LUCRO.LISDOACAOITEM between 1 and 1 and WRPT_VENDAS_LUCRO.LISDEVOLUCAO between 0 and 0 and ccdemp =1000 GROUP BY ccdger, ccdsup, ccdvend, cdsvend, ctpbonifica, cdstpbonifica
ORDER BY CDSTPBONIFICA,CCDVEND